
<!DOCTYPE html>
<html lang="ml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IASE Arts Fest 2026 - Live Results</title>
    <style>
        :root {
            --primary-color: #0d47a1; /* IASE Blue */
            --accent-color: #ffca28;
            --bg-color: #f8f9fa;
        }

        body {
            font-family: 'Segoe UI', Roboto, -apple-system, sans-serif;
            margin: 0;
            background-color: var(--bg-color);
            color: #333;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 35px 15px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        h1 { margin: 0; font-size: 1.8rem; letter-spacing: 1px; }

        .search-container {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        #itemSearch {
            width: 100%;
            padding: 15px;
            border-radius: 30px;
            border: 2px solid #ddd;
            font-size: 16px;
            outline: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .category-title {
            background: #fff;
            padding: 12px 20px;
            margin: 25px auto 10px;
            max-width: 1100px;
            border-left: 8px solid var(--accent-color);
            text-align: left;
            border-radius: 5px;
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--primary-color);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .item-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 15px;
            padding: 10px 20px 40px;
            max-width: 1100px;
            margin: 0 auto;
        }

        .item-btn {
            background: white;
            border: 1px solid #e0e0e0;
            padding: 15px 10px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            color: #444;
            transition: all 0.3s ease;
            min-height: 75px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .item-btn:hover {
            transform: translateY(-4px);
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            box-shadow: 0 6px 12px rgba(13, 71, 161, 0.2);
        }

        #resultView {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            width: 90%;
            max-width: 500px;
            border-radius: 24px;
            padding: 25px;
            position: relative;
            animation: slideIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes slideIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

        .back-btn {
            background: #f0f0f0;
            border: none;
            padding: 10px 18px;
            border-radius: 10px;
            cursor: pointer;
            margin-bottom: 20px;
            font-weight: bold;
            color: #555;
        }

        .result-card {
            background: #fff;
            margin: 12px 0;
            padding: 15px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            border: 1px solid #eee;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }

        .rank-box { font-size: 24px; font-weight: bold; margin-right: 20px; color: var(--primary-color); min-width: 40px; }
        .details b { display: block; font-size: 18px; margin-bottom: 2px; }
        .details span { font-size: 14px; color: #777; }

        footer { text-align: center; padding: 40px; color: #888; font-size: 14px; border-top: 1px solid #eee; }

        @media (max-width: 500px) {
            .item-grid { grid-template-columns: 1fr 1fr; }
            h1 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>

<header>
    <h1>IASE Arts Fest 2026 ‚Äì Live Results</h1>
</header>

<div class="search-container">
    <input type="text" id="itemSearch" placeholder="‡¥ê‡¥±‡µç‡¥±‡¥Ç ‡¥∏‡µÜ‡µº‡¥ö‡µç‡¥ö‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÇ..." onkeyup="filterItems()">
</div>

<div class="category-title">Stage Items</div>
<div class="item-grid" id="stageGrid"></div>

<div class="category-title">Off Stage Items</div>
<div class="item-grid" id="offStageGrid"></div>

<div id="resultView">
    <div class="modal-content">
        <button class="back-btn" onclick="closeResults()">‚Üê Back to Home</button>
        <h2 id="selectedItemTitle" style="color: var(--primary-color); margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px;">Item Name</h2>
        <div id="resultsContainer"></div>
    </div>
</div>
<div id="houseBoard" style="padding:20px; max-width:600px; margin:auto;">
    <h2 style="text-align:center; color:var(--primary-color)">üèÜ IASE House Leaderboard</h2>
    <div id="leaderboardContainer"></div>
    <p style="text-align:center; font-size:13px; color:#777;">
        Last Updated: <span id="lastUpdated">--</span>
    </p>
</div>
<footer>
    IASE Arts Fest 2026<br>
    Scan QR Code to View Live Updated Results
</footer>

<script>
    const HOUSE_COLORS = {
    "Red": "#e53935",
    "Yellow": "#fdd835",
    "Blue": "#1e88e5",
    "Green": "#43a047"
};
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSvr_vyPeraPYciyV4MuAdJRgnTjuXHR55hOBpWIv3Uvs1vsAaUz4pTI3jiNA8dK_bTqXR_JsibZyjX/pub?gid=0&single=true&output=csv';

    // ‡¥ê‡¥±‡µç‡¥±‡¥ô‡µç‡¥ô‡¥≥‡µÜ ‡¥∞‡¥£‡µç‡¥ü‡µç ‡¥µ‡¥ø‡¥≠‡¥æ‡¥ó‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥§‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ
    const categorisedItems = {
        "Stage": ["Light Music", "Poem Recitation (English)", "Poem Recitation (Malayalam)", "Poem Recitation (Hindi)", "Poem Recitation (Sanskrit)", "Poem Recitation (Arabic)", "Kadhaprasangam", "Mono Act", "Mappila Paatu", "Mimicry", "Nadodi Nritham", "Bharatanatyam", "Kuchipudi", "Mohiniyattam","Group Song", "Patriotic Song", "Folk Song", "Vanchipattu", "Oppana", "Margam Kali", "Thiruvathira Kali", "Group Dance"

], 
        "Off Stage": [
           "Essay Writing (Malayalam)", "Essay Writing (English)", "Essay Writing (Hindi)", "Essay Writing (Sanskrit)", "Short Story Writing (English)", "Short Story Writing (Malayalam)", "Short Story Writing (Hindi)", "Short Story Writing (Sanskrit)", "Poem Writing (English)", "Poem Writing (Malayalam)", "Poem Writing (Hindi)", "Poem Writing (Sanskrit)", "Quiz",  "Painting", "Oil Painting", "Water Colouring", "Cartoon", "Pencil Drawing"

        ]
    };

    let resultsData = [];

    function displayButtons() {
        const stageGrid = document.getElementById('stageGrid');
        categorisedItems["Stage"].forEach(item => stageGrid.appendChild(createBtn(item)));

        const offStageGrid = document.getElementById('offStageGrid');
        categorisedItems["Off Stage"].forEach(item => offStageGrid.appendChild(createBtn(item)));
    }

    function createBtn(item) {
        const btn = document.createElement('button');
        btn.className = 'item-btn';
        btn.innerText = item;
        btn.onclick = () => showResults(item);
        return btn;
    }

   async function loadSheetData() {
    try {
        const response = await fetch(SHEET_URL);
        const data = await response.text();
        resultsData = parseCSV(data);
        calculateHousePoints(); // leaderboard update
    } catch (e) { console.error("Data load error", e); }
}


    function parseCSV(text) {
        const rows = text.split('\n');
        const headers = rows[0].split(',').map(h => h.trim());
        return rows.slice(1).map(row => {
            const values = row.split(',').map(v => v.trim());
            let obj = {};
            headers.forEach((h, i) => obj[h] = values[i]);
            return obj;
        });
    }

    function showResults(itemName) {
        document.getElementById('selectedItemTitle').innerText = itemName;
        const container = document.getElementById('resultsContainer');
        container.innerHTML = '';

        const filtered = resultsData.filter(r => r.Item === itemName);
        
        [1, 2, 3].forEach(rank => {
            const winner = filtered.find(w => parseInt(w.Rank) === rank);
            const card = document.createElement('div');
            card.className = 'result-card';
            if (winner) {
                card.innerHTML = `<div class="rank-box">${rank}</div><div class="details"><b>${winner.Name}</b><span>
Class: ${winner.Class} |
House: ${winner.House} <br>
Published: ${winner.Timestamp}
</span>
</div>`;
            } else {
                card.innerHTML = `<div class="rank-box">${rank}</div><div class="details"><span>Updating soon...</span></div>`;
            }
            container.appendChild(card);
        });
        document.getElementById('resultView').style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }

    function closeResults() { 
        document.getElementById('resultView').style.display = 'none'; 
        document.body.style.overflow = 'auto';
    }

    function filterItems() {
        const search = document.getElementById('itemSearch').value.toLowerCase();
        const btns = document.querySelectorAll('.item-btn');
        btns.forEach(btn => {
            btn.style.display = btn.innerText.toLowerCase().includes(search) ? 'flex' : 'none';
        });
    }

    window.onload = () => {
    displayButtons();
    loadSheetData();

    // Auto refresh every 30 seconds
    setInterval(loadSheetData, 30000);
};



const GROUP_ITEMS = [
    "Group Song", "Patriotic Song", "Folk Song", "Vanchipattu", "Oppana", "Margam Kali", "Thiruvathira Kali", "Group Dance"

];
    const INDIVIDUAL_POINTS = {
    1: 5,
    2: 3,
    3: 1
};

const GROUP_POINTS = {
    1: 10,
    2: 7,
    3: 5
};

function calculateHousePoints(){

    let housePoints = {};

    resultsData.forEach(entry => {

        const rank = parseInt(entry.Rank);
        const item = entry.Item;

        let points = 0;

        // Check if group item
        if(GROUP_ITEMS.includes(item)){
            points = GROUP_POINTS[rank] || 0;
        } else {
            points = INDIVIDUAL_POINTS[rank] || 0;
        }

        if(points > 0){

            if(!housePoints[entry.House]){
                housePoints[entry.House] = 0;
            }

            housePoints[entry.House] += points;
        }

    });

    displayLeaderboard(housePoints);
}

    function displayLeaderboard(housePoints){

    const container = document.getElementById('leaderboardContainer');
    container.innerHTML = '';

    let sorted = Object.entries(housePoints)
        .sort((a,b)=> b[1] - a[1]);

    sorted.forEach((house,index)=>{

        const div = document.createElement('div');
        div.className = 'result-card';

        let houseColor = HOUSE_COLORS[house[0]] || "#999";

        div.style.borderLeft = "10px solid " + houseColor;

       div.innerHTML = `
    <div class="rank-box">${index+1}</div>
    <div class="details">
        <b>${house[0]} House</b>
        <span>${house[1]} Points</span>
    </div>
`;


        container.appendChild(div);
    });

    document.getElementById('lastUpdated').innerText =
        new Date().toLocaleTimeString();
    }
    document.getElementById('lastUpdated').innerText =
        new Date().toLocaleTimeString();
}
    window.onload = () => {
    displayButtons();
    loadSheetData();

    // Auto refresh every 30 seconds
    setInterval(loadSheetData, 30000);
};


    
</script>

</body>
</html>






